{% extends 'landing_base.html' %}
{% block content %}

<div class="container-sm"  style="">
    <div id="message" class="alert text-center" style="margin-top: 40px;" ></div>
</div>

<div class="container-sm"  style="margin:90px; background-color: aliceblue; padding:20px; border-radius: 20px;">
    <h2>Billing Details</h2>

    <!-- If no billing details exist, show a message -->
    {% if no_billing %}
    <div class="alert alert-info">
        You don't have any billing details yet. Please fill out the form below to add them.
    </div>
    {% endif %}

<!-- Billing form -->
<form method="POST" id="billing-form">
    {% csrf_token %}
    <div class="row">
        <!-- Left Column -->
        <div class="col-md-6">
            <div class="form-group">
                <label for="full_name">Full Name</label>
                <input type="text" class="form-control" placeholder="Enter Full Name" name="full_name" id="full_name" value="{{ form.full_name.value }}" required>
            </div>

            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" class="form-control" placeholder="Enter Address" name="address" id="address" value="{{ form.address.value }}" required>
            </div>

            <div class="form-group">
                <label for="city">City</label>
                <input type="text" class="form-control" placeholder="Enter City" name="city" id="city" value="{{ form.city.value }}" required>
            </div>

            <div class="form-group">
                <label for="postal_code">Postal Code</label>
                <input type="text" class="form-control" placeholder="Enter Postal Code" name="postal_code" id="postal_code" value="{{ form.postal_code.value }}" required>
            </div>
        </div>

        <!-- Right Column -->
        <div class="col-md-6">
            <div class="form-group">
                <label for="state">State/Province</label>
                <input type="text" class="form-control" placeholder="Enter State/Province" name="state" id="state" value="{{ form.state.value }}" required>
            </div>

            <div class="form-group">
                <label for="country">Country</label>
                <select class="form-control" name="country" id="country" required>
                   <!-- <option value="0">Select Country</option>-->
                </select>
            </div>

            <div class="form-group">
                <label for="phone_number">Phone Number</label>
                <input type="text" placeholder="Enter PhoneNumber" class="form-control" name="phone_number" id="phone_number" value="{{ form.phone_number.value }}" required>
            </div>

          
        </div>
    </div>

    <div class="row">
        <div class="col-md-12 text-center justify-content-between">
            <button  type="submit" class="btn btn-primary col-4">Save Shipping Details</button>
           
        </div>
    </div>
</form>

<a href="/payment/" class="btn btn-primary col-4">Proceed To Payment</a>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Example list of countries
        const countries = [
            { code: "AF", name: "Afghanistan" },
            { code: "AL", name: "Albania" },
            { code: "DZ", name: "Algeria" },
            { code: "US", name: "United States" },
            { code: "CA", name: "Canada" },
            // Add other countries here...
        ];
    
        const countrySelect = document.getElementById('country');
    
        // Dynamically populate country dropdown
        countries.forEach(function(country) {
            const option = document.createElement('option');
            option.value = country.name;
            option.text = country.name;
            countrySelect.appendChild(option);
        });
    
        // If a country is selected in the backend, set it
        const selectedCountry = "{{ form.country.value }}";
        if (selectedCountry) {
            countrySelect.value = selectedCountry;
        }
    
        // AJAX form submission logic (for demonstration purposes)
        const billingForm = document.getElementById('billing-form');
        billingForm.addEventListener('submit', function(event) {
            event.preventDefault();
    
            const formData = new FormData(billingForm);
            fetch("{% url 'billingDetails' %}", {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                }
            })
            .then(response => response.json())
            .then(data => {

                console.log(data,"etst")

                if (data.success) {
                   
                    message.textContent = 'Billing details saved successfully.';
                   
                } else {
                  
                    message.textContent = 'Error saving billing details. Please check your input.';
                   
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });
    });
    </script>
    
{% endblock %}
